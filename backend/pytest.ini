# =============================================================================
# NESTSECURE - Configuración de Pytest
# =============================================================================

[pytest]
# Directorio de tests
testpaths = tests app/tests

# Plugins y configuración async
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Formato de salida
addopts = 
    -v
    --strict-markers
    --tb=short
    -ra

# Markers personalizados
markers =
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (may require external services)
    slow: Slow tests (skip with -m "not slow")
    e2e: End-to-end tests
    security: Security tests
    database: Database tests

# Configuración de logging en tests
log_cli = true
log_cli_level = WARNING
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s (%(filename)s:%(lineno)s)

# Filtrar warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Variables de entorno para tests
env =
    ENVIRONMENT=testing
    DEBUG=true
    DATABASE_URL=postgresql+asyncpg://test:test@localhost:5432/test_nestsecure
    REDIS_URL=redis://localhost:6379/15
    SECRET_KEY=test-secret-key-for-testing-only
