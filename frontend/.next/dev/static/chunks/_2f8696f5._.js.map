{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,6LAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/lib/api.ts"],"sourcesContent":["import { useAuthStore } from './stores/auth-store';\nimport type {\n  LoginCredentials,\n  LoginResponse,\n  User,\n  Scan,\n  CreateScanPayload,\n  Asset,\n  CreateAssetPayload,\n  Vulnerability,\n  UpdateVulnerabilityPayload,\n  DashboardStats,\n  VulnerabilityTrend,\n  HealthStatus,\n  Service,\n  ScanResultsResponse,\n  ScanHostsResponse,\n  ScanLogsResponse,\n  CVE,\n  CVEMinimal,\n  CVESearchParams,\n  CVEStats,\n  CVESyncRequest,\n  CVESyncStatus,\n  CVELookupResponse,\n  PaginatedResponse,\n} from '@/types';\n\n/**\n * Obtener la URL base de la API según el entorno\n * - En el servidor (SSR): usar la URL interna de Docker (backend:8000)\n * - En el cliente (browser): usar localhost o la URL pública\n */\nfunction getApiBaseUrl(): string {\n  // En el cliente (browser)\n  if (typeof window !== 'undefined') {\n    // Usar la URL del browser (configurada en env o localhost)\n    return process.env.NEXT_PUBLIC_BROWSER_API_URL || \n           process.env.NEXT_PUBLIC_API_URL || \n           'http://localhost:8000/api/v1';\n  }\n  \n  // En el servidor (SSR/API routes) - usar URL interna de Docker\n  return process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000/api/v1';\n}\n\nconst API_BASE_URL = getApiBaseUrl();\n\nclass ApiClient {\n  private baseUrl: string;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const { accessToken, refreshToken, setTokens, logout } = useAuthStore.getState();\n\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    if (accessToken) {\n      (headers as Record<string, string>)['Authorization'] = `Bearer ${accessToken}`;\n    }\n\n    let response = await fetch(`${this.baseUrl}${endpoint}`, {\n      ...options,\n      headers,\n    });\n\n    // Handle 401 - try to refresh token\n    if (response.status === 401 && refreshToken) {\n      try {\n        const refreshResponse = await fetch(`${this.baseUrl}/auth/refresh`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ refresh_token: refreshToken }),\n        });\n\n        if (refreshResponse.ok) {\n          const tokens: LoginResponse = await refreshResponse.json();\n          setTokens(tokens.access_token, tokens.refresh_token);\n          \n          // Retry original request with new token\n          (headers as Record<string, string>)['Authorization'] = `Bearer ${tokens.access_token}`;\n          response = await fetch(`${this.baseUrl}${endpoint}`, {\n            ...options,\n            headers,\n          });\n        } else {\n          logout();\n          if (typeof window !== 'undefined') {\n            window.location.href = '/login';\n          }\n          throw new Error('Session expired');\n        }\n      } catch {\n        logout();\n        if (typeof window !== 'undefined') {\n          window.location.href = '/login';\n        }\n        throw new Error('Session expired');\n      }\n    }\n\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ detail: 'Request failed' }));\n      throw new Error(error.detail || `HTTP ${response.status}`);\n    }\n\n    return response.json();\n  }\n\n  // Auth\n  async login(credentials: LoginCredentials): Promise<LoginResponse> {\n    // El backend tiene /auth/login/json para JSON body\n    return this.request<LoginResponse>('/auth/login/json', {\n      method: 'POST',\n      body: JSON.stringify(credentials),\n    });\n  }\n\n  async refreshToken(refreshToken: string): Promise<LoginResponse> {\n    return this.request<LoginResponse>('/auth/refresh', {\n      method: 'POST',\n      body: JSON.stringify({ refresh_token: refreshToken }),\n    });\n  }\n\n  async getMe(): Promise<User> {\n    return this.request<User>('/auth/me');\n  }\n\n  // Dashboard\n  async getDashboardStats(): Promise<DashboardStats> {\n    return this.request<DashboardStats>('/dashboard/stats');\n  }\n\n  async getRecentScans(): Promise<Scan[]> {\n    return this.request<Scan[]>('/dashboard/recent-scans');\n  }\n\n  async getRecentAssets(): Promise<Asset[]> {\n    return this.request<Asset[]>('/dashboard/recent-assets');\n  }\n\n  async getVulnerabilityTrend(): Promise<VulnerabilityTrend[]> {\n    return this.request<VulnerabilityTrend[]>('/dashboard/vulnerability-trend');\n  }\n\n  // Scans\n  async getScans(params?: { status?: string; type?: string; search?: string; page?: number; page_size?: number }): Promise<{ items: Scan[]; total: number; page: number; pages: number }> {\n    const searchParams = new URLSearchParams();\n    if (params?.status) searchParams.append('status', params.status);\n    if (params?.type) searchParams.append('scan_type', params.type);\n    if (params?.search) searchParams.append('search', params.search);\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    \n    const query = searchParams.toString();\n    return this.request<{ items: Scan[]; total: number; page: number; pages: number }>(`/scans${query ? `?${query}` : ''}`);\n  }\n\n  async getScan(id: string): Promise<Scan> {\n    return this.request<Scan>(`/scans/${id}`);\n  }\n\n  async createScan(payload: CreateScanPayload): Promise<Scan> {\n    return this.request<Scan>('/scans', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async stopScan(id: string): Promise<Scan> {\n    return this.request<Scan>(`/scans/${id}/stop`, {\n      method: 'POST',\n    });\n  }\n\n  async deleteScan(id: string): Promise<void> {\n    return this.request<void>(`/scans/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async getScanResults(id: string, params?: { page?: number; page_size?: number; min_severity?: number }): Promise<ScanResultsResponse> {\n    const searchParams = new URLSearchParams();\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    if (params?.min_severity) searchParams.append('min_severity', params.min_severity.toString());\n    \n    const query = searchParams.toString();\n    return this.request<ScanResultsResponse>(`/scans/${id}/results${query ? `?${query}` : ''}`);\n  }\n\n  async getScanHosts(id: string): Promise<ScanHostsResponse> {\n    return this.request<ScanHostsResponse>(`/scans/${id}/hosts`);\n  }\n\n  async getScanLogs(id: string): Promise<ScanLogsResponse> {\n    return this.request<ScanLogsResponse>(`/scans/${id}/logs`);\n  }\n\n  // Assets\n  async getAssets(params?: { \n    type?: string; \n    criticality?: string; \n    status?: string;\n    search?: string;\n    page?: number;\n    page_size?: number;\n  }): Promise<{ items: Asset[]; total: number; page: number; pages: number }> {\n    const searchParams = new URLSearchParams();\n    if (params?.type) searchParams.append('type', params.type);\n    if (params?.criticality) searchParams.append('criticality', params.criticality);\n    if (params?.status) searchParams.append('status', params.status);\n    if (params?.search) searchParams.append('search', params.search);\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    \n    const query = searchParams.toString();\n    return this.request<{ items: Asset[]; total: number; page: number; pages: number }>(`/assets${query ? `?${query}` : ''}`);\n  }\n\n  async getAsset(id: string): Promise<Asset> {\n    return this.request<Asset>(`/assets/${id}`);\n  }\n\n  async createAsset(payload: CreateAssetPayload): Promise<Asset> {\n    return this.request<Asset>('/assets', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async updateAsset(id: string, payload: Partial<CreateAssetPayload>): Promise<Asset> {\n    return this.request<Asset>(`/assets/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async deleteAsset(id: string): Promise<void> {\n    return this.request<void>(`/assets/${id}`, {\n      method: 'DELETE',\n    });\n  }\n\n  async getAssetServices(id: string): Promise<Service[]> {\n    return this.request<Service[]>(`/assets/${id}/services`);\n  }\n\n  async getAssetVulnerabilities(id: string): Promise<Vulnerability[]> {\n    return this.request<Vulnerability[]>(`/assets/${id}/vulnerabilities`);\n  }\n\n  async getAssetScans(id: string): Promise<Scan[]> {\n    return this.request<Scan[]>(`/assets/${id}/scans`);\n  }\n\n  // Vulnerabilities\n  async getVulnerabilities(params?: {\n    severity?: string;\n    status?: string;\n    search?: string;\n    sort_by?: string;\n    sort_order?: 'asc' | 'desc';\n  }): Promise<Vulnerability[]> {\n    const searchParams = new URLSearchParams();\n    if (params?.severity) searchParams.append('severity', params.severity);\n    if (params?.status) searchParams.append('status', params.status);\n    if (params?.search) searchParams.append('search', params.search);\n    if (params?.sort_by) searchParams.append('sort_by', params.sort_by);\n    if (params?.sort_order) searchParams.append('sort_order', params.sort_order);\n    \n    const query = searchParams.toString();\n    return this.request<Vulnerability[]>(`/vulnerabilities${query ? `?${query}` : ''}`);\n  }\n\n  async getVulnerability(id: string): Promise<Vulnerability> {\n    return this.request<Vulnerability>(`/vulnerabilities/${id}`);\n  }\n\n  async updateVulnerability(id: string, payload: UpdateVulnerabilityPayload): Promise<Vulnerability> {\n    return this.request<Vulnerability>(`/vulnerabilities/${id}`, {\n      method: 'PUT',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  // Users\n  async getUsers(): Promise<User[]> {\n    return this.request<User[]>('/users');\n  }\n\n  async getUser(userId: string): Promise<User> {\n    return this.request<User>(`/users/${userId}`);\n  }\n\n  async getCurrentUser(): Promise<User> {\n    return this.request<User>('/users/me');\n  }\n\n  async updateUser(userId: string, payload: { \n    full_name?: string; \n    first_name?: string;\n    last_name?: string;\n    email?: string;\n    is_active?: boolean;\n  }): Promise<User> {\n    return this.request<User>(`/users/${userId}`, {\n      method: 'PATCH',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  async changePassword(userId: string, payload: {\n    current_password: string;\n    new_password: string;\n  }): Promise<{ message: string }> {\n    return this.request<{ message: string }>(`/users/${userId}/password`, {\n      method: 'PATCH',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  // Health\n  async getHealthStatus(): Promise<HealthStatus> {\n    return this.request<HealthStatus>('/health/services');\n  }\n\n  // ==========================================================================\n  // CVE Endpoints\n  // ==========================================================================\n\n  /**\n   * Search CVEs with filters and pagination\n   */\n  async searchCVEs(params?: CVESearchParams): Promise<PaginatedResponse<CVEMinimal>> {\n    const searchParams = new URLSearchParams();\n    \n    if (params?.search) searchParams.append('search', params.search);\n    if (params?.severity) searchParams.append('severity', params.severity);\n    if (params?.min_cvss !== undefined) searchParams.append('min_cvss', params.min_cvss.toString());\n    if (params?.max_cvss !== undefined) searchParams.append('max_cvss', params.max_cvss.toString());\n    if (params?.has_exploit !== undefined) searchParams.append('has_exploit', params.has_exploit.toString());\n    if (params?.in_cisa_kev !== undefined) searchParams.append('in_cisa_kev', params.in_cisa_kev.toString());\n    if (params?.vendor) searchParams.append('vendor', params.vendor);\n    if (params?.product) searchParams.append('product', params.product);\n    if (params?.published_after) searchParams.append('published_after', params.published_after);\n    if (params?.published_before) searchParams.append('published_before', params.published_before);\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    \n    const query = searchParams.toString();\n    return this.request<PaginatedResponse<CVEMinimal>>(`/cve${query ? `?${query}` : ''}`);\n  }\n\n  /**\n   * Get a specific CVE by ID (e.g., CVE-2024-1234)\n   */\n  async getCVE(cveId: string): Promise<CVE> {\n    return this.request<CVE>(`/cve/${encodeURIComponent(cveId)}`);\n  }\n\n  /**\n   * Lookup multiple CVEs at once\n   */\n  async lookupCVEs(cveIds: string[]): Promise<CVELookupResponse> {\n    return this.request<CVELookupResponse>('/cve/lookup', {\n      method: 'POST',\n      body: JSON.stringify({ cve_ids: cveIds }),\n    });\n  }\n\n  /**\n   * Get CVE statistics\n   */\n  async getCVEStats(): Promise<CVEStats> {\n    return this.request<CVEStats>('/cve/stats');\n  }\n\n  /**\n   * Trigger CVE sync from NVD (Admin only)\n   */\n  async syncCVEs(params?: CVESyncRequest): Promise<{ message: string; task_id: string }> {\n    return this.request<{ message: string; task_id: string }>('/cve/sync', {\n      method: 'POST',\n      body: JSON.stringify(params || {}),\n    });\n  }\n\n  /**\n   * Get CVE sync status\n   */\n  async getCVESyncStatus(): Promise<CVESyncStatus> {\n    return this.request<CVESyncStatus>('/cve/sync/status');\n  }\n\n  /**\n   * Get CVEs related to a specific vulnerability\n   */\n  async getVulnerabilityCVE(vulnerabilityId: string): Promise<CVE | null> {\n    try {\n      return await this.request<CVE>(`/vulnerabilities/${vulnerabilityId}/cve`);\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Get trending CVEs (most accessed/critical)\n   */\n  async getTrendingCVEs(limit: number = 10): Promise<CVEMinimal[]> {\n    return this.request<CVEMinimal[]>(`/cve/trending?limit=${limit}`);\n  }\n\n  /**\n   * Get CVEs in CISA KEV (Known Exploited Vulnerabilities)\n   */\n  async getKEVCVEs(params?: { page?: number; page_size?: number }): Promise<PaginatedResponse<CVEMinimal>> {\n    const searchParams = new URLSearchParams();\n    searchParams.append('in_cisa_kev', 'true');\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    \n    return this.request<PaginatedResponse<CVEMinimal>>(`/cve?${searchParams.toString()}`);\n  }\n\n  /**\n   * Get CVEs with known exploits\n   */\n  async getExploitableCVEs(params?: { page?: number; page_size?: number }): Promise<PaginatedResponse<CVEMinimal>> {\n    const searchParams = new URLSearchParams();\n    searchParams.append('has_exploit', 'true');\n    if (params?.page) searchParams.append('page', params.page.toString());\n    if (params?.page_size) searchParams.append('page_size', params.page_size.toString());\n    \n    return this.request<PaginatedResponse<CVEMinimal>>(`/cve?${searchParams.toString()}`);\n  }\n\n  // ==========================================================================\n  // Network Validation\n  // ==========================================================================\n\n  /**\n   * Validate a scan target (IP or CIDR)\n   * Only private networks (RFC 1918) are allowed\n   */\n  async validateTarget(target: string): Promise<{\n    valid: boolean;\n    target: string;\n    type: 'ip' | 'cidr' | null;\n    error: string | null;\n    info: Record<string, unknown> | null;\n  }> {\n    return this.request('/network/validate', {\n      method: 'POST',\n      body: JSON.stringify({ target }),\n    });\n  }\n\n  /**\n   * Validate multiple scan targets at once\n   */\n  async validateMultipleTargets(targets: string[]): Promise<{\n    valid: boolean;\n    targets: Array<{\n      valid: boolean;\n      target: string;\n      type: 'ip' | 'cidr' | null;\n      error: string | null;\n    }>;\n    total: number;\n    valid_count: number;\n    invalid_count: number;\n  }> {\n    return this.request('/network/validate-multiple', {\n      method: 'POST',\n      body: JSON.stringify({ targets }),\n    });\n  }\n\n  /**\n   * Get information about a CIDR network\n   */\n  async getNetworkInfo(cidr: string): Promise<{\n    network: string;\n    netmask: string;\n    broadcast: string;\n    num_hosts: number;\n    first_host: string | null;\n    last_host: string | null;\n    prefix_length: number;\n    is_private: boolean;\n  }> {\n    return this.request(`/network/info/${encodeURIComponent(cidr)}`);\n  }\n\n  /**\n   * Get allowed private IP ranges for scanning\n   */\n  async getPrivateRanges(): Promise<{\n    description: string;\n    ranges: Array<{\n      name: string;\n      cidr: string;\n      range: string;\n      hosts: number;\n    }>;\n  }> {\n    return this.request('/network/private-ranges');\n  }\n\n  /**\n   * Check if an IP is private (can be scanned)\n   */\n  async checkIP(ip: string): Promise<{\n    ip: string;\n    is_private: boolean;\n    can_scan: boolean;\n    details: Record<string, unknown>;\n  }> {\n    return this.request(`/network/check-ip/${encodeURIComponent(ip)}`);\n  }\n\n  // ===========================================================================\n  // CORRELATION API\n  // ===========================================================================\n\n  /**\n   * Correlate a service with CVEs from NVD\n   */\n  async correlateService(\n    serviceId: string,\n    options?: { autoCreateVuln?: boolean; maxCves?: number }\n  ): Promise<{\n    service_id: string;\n    cpe: string | null;\n    cpe_confidence: number;\n    cves_found: number;\n    vulnerabilities_created: number;\n    status: string;\n    cves: string[];\n    error: string | null;\n  }> {\n    return this.request(`/correlation/services/${serviceId}/correlate`, {\n      method: 'POST',\n      body: JSON.stringify({\n        auto_create_vuln: options?.autoCreateVuln ?? true,\n        max_cves: options?.maxCves ?? 10,\n      }),\n    });\n  }\n\n  /**\n   * Correlate all services of a scan with CVEs\n   */\n  async correlateScan(\n    scanId: string,\n    options?: { autoCreate?: boolean; maxCvesPerService?: number }\n  ): Promise<{\n    scan_id: string;\n    services_processed: number;\n    services_with_cpe: number;\n    cves_found: number;\n    vulnerabilities_created: number;\n    status: string;\n    services: Array<{\n      service_id: string;\n      cpe: string | null;\n      cves_found: number;\n      status: string;\n    }>;\n  }> {\n    const params = new URLSearchParams();\n    if (options?.autoCreate !== undefined) {\n      params.set('auto_create', String(options.autoCreate));\n    }\n    if (options?.maxCvesPerService) {\n      params.set('max_cves_per_service', String(options.maxCvesPerService));\n    }\n    \n    return this.request(`/correlation/scans/${scanId}/correlate?${params}`, {\n      method: 'POST',\n    });\n  }\n\n  /**\n   * Correlate all services of an asset with CVEs\n   */\n  async correlateAsset(\n    assetId: string,\n    autoCreate: boolean = true\n  ): Promise<{\n    asset_id: string;\n    services_processed: number;\n    cves_found: number;\n    vulnerabilities_created: number;\n    services: Array<{\n      service_id: string;\n      cpe: string | null;\n      cves_found: number;\n    }>;\n  }> {\n    return this.request(\n      `/correlation/assets/${assetId}/correlate?auto_create=${autoCreate}`,\n      { method: 'POST' }\n    );\n  }\n\n  /**\n   * Get CPE information for a service\n   */\n  async getServiceCPE(serviceId: string): Promise<{\n    service_id: string;\n    port: number;\n    protocol: string;\n    service_name: string | null;\n    product: string | null;\n    version: string | null;\n    cpe: string | null;\n    cpe_source: string;\n    confidence: number;\n  }> {\n    return this.request(`/correlation/cpe/${serviceId}`);\n  }\n\n  // ==========================================================================\n  // NUCLEI SCANNING API\n  // ==========================================================================\n\n  /**\n   * Start a Nuclei vulnerability scan\n   */\n  async startNucleiScan(params: {\n    target: string;\n    profile?: string;\n    scan_name?: string;\n    timeout?: number;\n    tags?: string[];\n    severities?: string[];\n  }): Promise<{\n    task_id: string;\n    scan_id: string;\n    status: string;\n    target: string;\n    profile: string;\n    message: string;\n  }> {\n    return this.request('/nuclei/scan', {\n      method: 'POST',\n      body: JSON.stringify(params),\n    });\n  }\n\n  /**\n   * Get Nuclei scan status\n   */\n  async getNucleiScanStatus(taskId: string): Promise<{\n    task_id: string;\n    scan_id: string | null;\n    status: string;\n    target: string;\n    profile: string | null;\n    started_at: string | null;\n    completed_at: string | null;\n    total_findings: number | null;\n    unique_cves: string[];\n    summary: {\n      critical: number;\n      high: number;\n      medium: number;\n      low: number;\n      info: number;\n      total: number;\n    } | null;\n    error_message: string | null;\n  }> {\n    return this.request(`/nuclei/scan/${taskId}`);\n  }\n\n  /**\n   * Get Nuclei scan results\n   */\n  async getNucleiScanResults(\n    taskId: string,\n    options?: {\n      page?: number;\n      page_size?: number;\n      severity?: string;\n    }\n  ): Promise<{\n    task_id: string;\n    scan_id: string | null;\n    status: string;\n    target: string;\n    profile: string | null;\n    started_at: string | null;\n    completed_at: string | null;\n    summary: {\n      critical: number;\n      high: number;\n      medium: number;\n      low: number;\n      info: number;\n      total: number;\n    };\n    findings: Array<{\n      template_id: string;\n      template_name: string;\n      severity: string;\n      host: string;\n      matched_at: string;\n      ip: string | null;\n      timestamp: string | null;\n      cve: string | null;\n      cvss: number | null;\n      cwe_id: string | null;\n      description: string | null;\n      references: string[] | null;\n      extracted: string[] | null;\n      matcher_name: string | null;\n    }>;\n    total_findings: number;\n    unique_cves: string[];\n    page: number;\n    page_size: number;\n    total_pages: number;\n  }> {\n    const params = new URLSearchParams();\n    if (options?.page) params.set('page', String(options.page));\n    if (options?.page_size) params.set('page_size', String(options.page_size));\n    if (options?.severity) params.set('severity', options.severity);\n\n    const query = params.toString();\n    return this.request(`/nuclei/scan/${taskId}/results${query ? `?${query}` : ''}`);\n  }\n\n  /**\n   * Get available Nuclei scan profiles\n   */\n  async getNucleiProfiles(): Promise<{\n    profiles: Array<{\n      name: string;\n      display_name: string;\n      description: string;\n      estimated_time: string;\n      tags: string[];\n      severities: string[];\n      templates_count: number | null;\n    }>;\n  }> {\n    return this.request('/nuclei/profiles');\n  }\n\n  /**\n   * Quick Nuclei scan (critical vulnerabilities only)\n   */\n  async nucleiQuickScan(target: string, scanName?: string): Promise<{\n    task_id: string;\n    scan_id: string;\n    status: string;\n    target: string;\n    profile: string;\n    message: string;\n  }> {\n    return this.request('/nuclei/quick', {\n      method: 'POST',\n      body: JSON.stringify({ target, scan_name: scanName }),\n    });\n  }\n\n  /**\n   * CVE-focused Nuclei scan\n   */\n  async nucleiCVEScan(\n    target: string,\n    cves?: string[],\n    scanName?: string\n  ): Promise<{\n    task_id: string;\n    scan_id: string;\n    status: string;\n    target: string;\n    profile: string;\n    message: string;\n  }> {\n    return this.request('/nuclei/cve', {\n      method: 'POST',\n      body: JSON.stringify({ target, cves, scan_name: scanName }),\n    });\n  }\n\n  /**\n   * Web vulnerability Nuclei scan\n   */\n  async nucleiWebScan(target: string, scanName?: string): Promise<{\n    task_id: string;\n    scan_id: string;\n    status: string;\n    target: string;\n    profile: string;\n    message: string;\n  }> {\n    return this.request('/nuclei/web', {\n      method: 'POST',\n      body: JSON.stringify({ target, scan_name: scanName }),\n    });\n  }\n\n  /**\n   * Cancel a running Nuclei scan\n   */\n  async cancelNucleiScan(taskId: string): Promise<{\n    task_id: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request(`/nuclei/scan/${taskId}/cancel`, {\n      method: 'POST',\n    });\n  }\n\n  /**\n   * Get Nuclei scanner health/status\n   */\n  async getNucleiHealth(): Promise<{\n    status: string;\n    nuclei_installed: boolean;\n    nuclei_version: string | null;\n    templates_path: string | null;\n    templates_count: number | null;\n    last_updated: string | null;\n  }> {\n    return this.request('/nuclei/health');\n  }\n\n  // =========================================================================\n  // ZAP API\n  // =========================================================================\n\n  /**\n   * Start a ZAP scan\n   */\n  async startZapScan(params: {\n    target_url: string;\n    mode?: 'quick' | 'standard' | 'full' | 'api' | 'passive' | 'spa';\n    asset_id?: string;\n    include_patterns?: string[];\n    exclude_patterns?: string[];\n    timeout?: number;\n  }): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/zap/scan', {\n      method: 'POST',\n      body: JSON.stringify(params),\n    });\n  }\n\n  /**\n   * Get ZAP scan status\n   */\n  async getZapScanStatus(taskId: string): Promise<{\n    task_id: string;\n    status: string;\n    progress?: {\n      phase: string;\n      spider_progress: number;\n      ajax_spider_progress: number;\n      active_scan_progress: number;\n      passive_scan_pending: number;\n      urls_found: number;\n      alerts_found: number;\n      overall_progress: number;\n      elapsed_seconds: number;\n    };\n    started_at?: string;\n    completed_at?: string;\n    error?: string;\n  }> {\n    return this.request(`/zap/scan/${taskId}`);\n  }\n\n  /**\n   * Get ZAP scan results\n   */\n  async getZapScanResults(taskId: string): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    success: boolean;\n    started_at: string;\n    completed_at: string;\n    duration_seconds: number;\n    urls_found: number;\n    alerts_count: number;\n    alerts_summary: {\n      informational: number;\n      low: number;\n      medium: number;\n      high: number;\n      total: number;\n    };\n    alerts: Array<{\n      id: string;\n      name: string;\n      risk: string;\n      confidence: string;\n      url: string;\n      method: string;\n      param?: string;\n      attack?: string;\n      evidence?: string;\n      description: string;\n      solution: string;\n      reference?: string;\n      cwe_id?: number;\n      wasc_id?: number;\n      owasp_top_10?: string;\n      plugin_id: number;\n    }>;\n    errors: string[];\n    spider_scan_id?: string;\n    active_scan_id?: string;\n    context_name?: string;\n  }> {\n    return this.request(`/zap/scan/${taskId}/results`);\n  }\n\n  /**\n   * Cancel a ZAP scan\n   */\n  async cancelZapScan(taskId: string): Promise<void> {\n    return this.request(`/zap/scan/${taskId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  /**\n   * Quick ZAP scan (Spider + Passive only)\n   */\n  async zapQuickScan(targetUrl: string, assetId?: string): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/zap/quick', {\n      method: 'POST',\n      body: JSON.stringify({ target_url: targetUrl, asset_id: assetId }),\n    });\n  }\n\n  /**\n   * Full ZAP scan (Spider + Ajax Spider + Active Scan)\n   */\n  async zapFullScan(targetUrl: string, assetId?: string): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/zap/full', {\n      method: 'POST',\n      body: JSON.stringify({ target_url: targetUrl, asset_id: assetId }),\n    });\n  }\n\n  /**\n   * ZAP API scan (for REST/GraphQL APIs)\n   */\n  async zapApiScan(\n    targetUrl: string,\n    openapiUrl?: string,\n    assetId?: string\n  ): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/zap/api', {\n      method: 'POST',\n      body: JSON.stringify({\n        target_url: targetUrl,\n        openapi_url: openapiUrl,\n        asset_id: assetId,\n      }),\n    });\n  }\n\n  /**\n   * ZAP SPA scan (for Single Page Applications)\n   */\n  async zapSpaScan(targetUrl: string, assetId?: string): Promise<{\n    task_id: string;\n    target_url: string;\n    mode: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/zap/spa', {\n      method: 'POST',\n      body: JSON.stringify({ target_url: targetUrl, asset_id: assetId }),\n    });\n  }\n\n  /**\n   * Get ZAP scan profiles\n   */\n  async getZapProfiles(): Promise<{\n    profiles: Array<{\n      id: string;\n      name: string;\n      description: string;\n      spider: boolean;\n      ajax_spider: boolean;\n      active_scan: boolean;\n      api_scan: boolean;\n      timeout: number;\n    }>;\n    total: number;\n  }> {\n    return this.request('/zap/profiles');\n  }\n\n  /**\n   * Get ZAP version and status\n   */\n  async getZapVersion(): Promise<{\n    version: string;\n    available: boolean;\n    host: string;\n    port: number;\n  }> {\n    return this.request('/zap/version');\n  }\n\n  /**\n   * Get current ZAP alerts\n   */\n  async getZapAlerts(options?: {\n    base_url?: string;\n    risk?: number;\n    start?: number;\n    count?: number;\n  }): Promise<Array<{\n    id: string;\n    name: string;\n    risk: string;\n    confidence: string;\n    url: string;\n    method: string;\n    param?: string;\n    description: string;\n    solution: string;\n    cwe_id?: number;\n    plugin_id: number;\n  }>> {\n    const params = new URLSearchParams();\n    if (options?.base_url) params.set('base_url', options.base_url);\n    if (options?.risk !== undefined) params.set('risk', String(options.risk));\n    if (options?.start !== undefined) params.set('start', String(options.start));\n    if (options?.count !== undefined) params.set('count', String(options.count));\n\n    const query = params.toString();\n    return this.request(`/zap/alerts${query ? `?${query}` : ''}`);\n  }\n\n  /**\n   * Get ZAP alerts summary\n   */\n  async getZapAlertsSummary(baseUrl?: string): Promise<{\n    informational: number;\n    low: number;\n    medium: number;\n    high: number;\n    total: number;\n  }> {\n    const params = baseUrl ? `?base_url=${encodeURIComponent(baseUrl)}` : '';\n    return this.request(`/zap/alerts/summary${params}`);\n  }\n\n  /**\n   * Clear ZAP session\n   */\n  async clearZapSession(): Promise<void> {\n    return this.request('/zap/clear', {\n      method: 'POST',\n    });\n  }\n\n  // ==========================================================================\n  // Reports Endpoints\n  // ==========================================================================\n\n  /**\n   * Get reports list\n   */\n  async getReports(params?: {\n    report_type?: string;\n    status?: string;\n    page?: number;\n    page_size?: number;\n  }): Promise<{\n    reports: Array<{\n      id: string;\n      name: string;\n      report_type: string;\n      format: string;\n      status: string;\n      created_at: string;\n      completed_at?: string;\n      is_downloadable: boolean;\n    }>;\n    total: number;\n    page: number;\n    page_size: number;\n  }> {\n    const searchParams = new URLSearchParams();\n    if (params?.report_type) searchParams.set('report_type', params.report_type);\n    if (params?.status) searchParams.set('status', params.status);\n    if (params?.page) searchParams.set('page', String(params.page));\n    if (params?.page_size) searchParams.set('page_size', String(params.page_size));\n\n    const query = searchParams.toString();\n    return this.request(`/reports${query ? `?${query}` : ''}`);\n  }\n\n  /**\n   * Generate new report\n   */\n  async generateReport(payload: {\n    name: string;\n    report_type: string;\n    format: string;\n    description?: string;\n    date_from?: string;\n    date_to?: string;\n    severity_filter?: string[];\n    status_filter?: string[];\n    asset_ids?: string[];\n  }): Promise<{\n    id: string;\n    status: string;\n    message: string;\n  }> {\n    return this.request('/reports/generate', {\n      method: 'POST',\n      body: JSON.stringify(payload),\n    });\n  }\n\n  /**\n   * Get report detail\n   */\n  async getReport(id: string): Promise<{\n    id: string;\n    name: string;\n    report_type: string;\n    format: string;\n    status: string;\n    description?: string;\n    file_size?: number;\n    parameters?: Record<string, unknown>;\n    error_message?: string;\n    completed_at?: string;\n    created_by_id?: string;\n    is_downloadable: boolean;\n    created_at: string;\n    updated_at: string;\n  }> {\n    return this.request(`/reports/${id}`);\n  }\n\n  /**\n   * Get report download URL\n   */\n  getReportDownloadUrl(id: string): string {\n    const { accessToken } = useAuthStore.getState();\n    // For direct download we return the URL with auth in headers handled separately\n    return `${this.baseUrl}/reports/${id}/download`;\n  }\n\n  /**\n   * Download report (returns blob)\n   */\n  async downloadReport(id: string): Promise<Blob> {\n    const { accessToken } = useAuthStore.getState();\n    const response = await fetch(`${this.baseUrl}/reports/${id}/download`, {\n      headers: {\n        'Authorization': `Bearer ${accessToken}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to download report');\n    }\n\n    return response.blob();\n  }\n\n  /**\n   * Delete report\n   */\n  async deleteReport(id: string): Promise<{ message: string; deleted_id: string }> {\n    return this.request(`/reports/${id}`, {\n      method: 'DELETE',\n    });\n  }\n}\n\nexport const api = new ApiClient(API_BASE_URL);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 913, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/hooks/use-auth.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuthStore } from '@/lib/stores/auth-store';\nimport { api } from '@/lib/api';\nimport type { LoginCredentials } from '@/types';\n\nexport function useAuth() {\n  const router = useRouter();\n  const { \n    user, \n    accessToken, \n    isAuthenticated, \n    isLoading,\n    setUser, \n    setTokens, \n    logout: storeLogout,\n    setLoading,\n  } = useAuthStore();\n\n  // Initialize auth state on mount\n  useEffect(() => {\n    const initAuth = async () => {\n      if (accessToken && !user) {\n        try {\n          const userData = await api.getMe();\n          setUser(userData);\n        } catch {\n          storeLogout();\n        }\n      }\n      setLoading(false);\n    };\n\n    initAuth();\n  }, [accessToken, user, setUser, storeLogout, setLoading]);\n\n  const login = useCallback(async (credentials: LoginCredentials) => {\n    const response = await api.login(credentials);\n    setTokens(response.access_token, response.refresh_token);\n    \n    const userData = await api.getMe();\n    setUser(userData);\n    \n    router.push('/');\n  }, [setTokens, setUser, router]);\n\n  const logout = useCallback(() => {\n    storeLogout();\n    router.push('/login');\n  }, [storeLogout, router]);\n\n  return {\n    user,\n    isAuthenticated,\n    isLoading,\n    login,\n    logout,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;AALA;;;;;AAQO,SAAS;;IACd,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,EACJ,IAAI,EACJ,WAAW,EACX,eAAe,EACf,SAAS,EACT,OAAO,EACP,SAAS,EACT,QAAQ,WAAW,EACnB,UAAU,EACX,GAAG,IAAA,iJAAY;IAEhB,iCAAiC;IACjC,IAAA,0KAAS;6BAAC;YACR,MAAM;8CAAW;oBACf,IAAI,eAAe,CAAC,MAAM;wBACxB,IAAI;4BACF,MAAM,WAAW,MAAM,oHAAG,CAAC,KAAK;4BAChC,QAAQ;wBACV,EAAE,OAAM;4BACN;wBACF;oBACF;oBACA,WAAW;gBACb;;YAEA;QACF;4BAAG;QAAC;QAAa;QAAM;QAAS;QAAa;KAAW;IAExD,MAAM,QAAQ,IAAA,4KAAW;sCAAC,OAAO;YAC/B,MAAM,WAAW,MAAM,oHAAG,CAAC,KAAK,CAAC;YACjC,UAAU,SAAS,YAAY,EAAE,SAAS,aAAa;YAEvD,MAAM,WAAW,MAAM,oHAAG,CAAC,KAAK;YAChC,QAAQ;YAER,OAAO,IAAI,CAAC;QACd;qCAAG;QAAC;QAAW;QAAS;KAAO;IAE/B,MAAM,SAAS,IAAA,4KAAW;uCAAC;YACzB;YACA,OAAO,IAAI,CAAC;QACd;sCAAG;QAAC;QAAa;KAAO;IAExB,OAAO;QACL;QACA;QACA;QACA;QACA;IACF;AACF;GApDgB;;QACC,kJAAS;QAUpB,iJAAY"}},
    {"offset": {"line": 999, "column": 0}, "map": {"version":3,"sources":["file:///Users/fabianramos/Desktop/NESTSECURE/frontend/app/%28auth%29/login/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Shield, Loader2, Eye, EyeOff } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { useAuth } from '@/hooks/use-auth';\nimport { useToast } from '@/hooks/use-toast';\n\nconst loginSchema = z.object({\n  email: z.string().email('Correo electrónico inválido'),\n  password: z.string().min(6, 'La contraseña debe tener al menos 6 caracteres'),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function LoginPage() {\n  const [showPassword, setShowPassword] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const { login } = useAuth();\n  const { toast } = useToast();\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n  });\n\n  const onSubmit = async (data: LoginFormData) => {\n    setIsLoading(true);\n    try {\n      await login(data);\n      toast({\n        title: 'Bienvenido',\n        description: 'Has iniciado sesión correctamente.',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error de autenticación',\n        description: error instanceof Error ? error.message : 'Credenciales inválidas',\n        variant: 'destructive',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      {/* Background pattern */}\n      <div className=\"absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-primary/10 via-background to-background\" />\n      \n      {/* Grid pattern overlay */}\n      <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmdiYSgxMDAsMTE2LDEzOSwwLjA1KSIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+')] opacity-40\" />\n      \n      <Card className=\"w-full max-w-md relative z-10 border-border/50 bg-card/80 backdrop-blur-sm\">\n        <CardHeader className=\"space-y-4 text-center\">\n          {/* Logo */}\n          <div className=\"flex justify-center\">\n            <div className=\"flex items-center gap-2 text-primary\">\n              <div className=\"p-2 rounded-lg bg-primary/10 border border-primary/20\">\n                <Shield className=\"h-8 w-8\" />\n              </div>\n            </div>\n          </div>\n          <div className=\"space-y-1\">\n            <CardTitle className=\"text-2xl font-bold tracking-tight\">\n              NEST<span className=\"text-primary\">SECURE</span>\n            </CardTitle>\n            <CardDescription className=\"text-muted-foreground\">\n              Plataforma de Gestión de Seguridad\n            </CardDescription>\n          </div>\n        </CardHeader>\n        \n        <CardContent>\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Correo electrónico</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                placeholder=\"admin@nestsecure.com\"\n                {...register('email')}\n                className=\"bg-background/50\"\n                disabled={isLoading}\n              />\n              {errors.email && (\n                <p className=\"text-sm text-destructive\">{errors.email.message}</p>\n              )}\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Contraseña</Label>\n              <div className=\"relative\">\n                <Input\n                  id=\"password\"\n                  type={showPassword ? 'text' : 'password'}\n                  placeholder=\"••••••••\"\n                  {...register('password')}\n                  className=\"bg-background/50 pr-10\"\n                  disabled={isLoading}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors\"\n                  tabIndex={-1}\n                >\n                  {showPassword ? (\n                    <EyeOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4\" />\n                  )}\n                </button>\n              </div>\n              {errors.password && (\n                <p className=\"text-sm text-destructive\">{errors.password.message}</p>\n              )}\n            </div>\n\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Iniciando sesión...\n                </>\n              ) : (\n                'Iniciar Sesión'\n              )}\n            </Button>\n          </form>\n\n          <div className=\"mt-4 text-center\">\n            <button\n              type=\"button\"\n              className=\"text-sm text-muted-foreground hover:text-primary transition-colors\"\n            >\n              ¿Olvidaste tu contraseña?\n            </button>\n          </div>\n        </CardContent>\n      </Card>\n      \n      {/* Footer */}\n      <div className=\"absolute bottom-4 text-center text-xs text-muted-foreground\">\n        <p>Security Operations Center</p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}